<!DOCTYPE html>
<html>
<head>
<title>Gesture Racing Game</title>

<style>
body{
background:#000;
color:white;
text-align:center;
font-family:Arial;
margin:0;
overflow:hidden;
}

canvas{
border:2px solid cyan;
background:#111;
margin-top:10px;
}

video{
display:none;
transform: scaleX(-1); /* Mirror camera for natural feel */
}
</style>
</head>
<body>

<h2>âœ‹ AI Gesture Car Racing</h2>
<h3 id="score">Score: 0</h3>

<video id="video" width="320" height="240" autoplay playsinline></video>
<canvas id="game" width="300" height="500"></canvas>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/handpose"></script>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let score = 0;

// ğŸš— Player
const player = {
x:130,
y:400,
w:40,
h:80
};

// ğŸš™ Enemy
let enemy = {
x:Math.random()*260,
y:-100,
w:40,
h:80,
speed:5
};

// ğŸ¥ Start Camera
async function setupCamera(){
const stream = await navigator.mediaDevices.getUserMedia({
video:{width:320,height:240}
});
video.srcObject = stream;

return new Promise(resolve=>{
video.onloadedmetadata=()=>{
video.play();
resolve(video);
};
});
}

// ğŸ’¥ Collision
function collide(a,b){
return(
a.x < b.x + b.w &&
a.x + a.w > b.x &&
a.y < b.y + b.h &&
a.y + a.h > b.y
);
}

// ğŸ® Draw Game
function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);

// Road moving line
ctx.fillStyle="white";
for(let i=0;i<500;i+=40){
ctx.fillRect(145,(i+enemy.y)%500,10,20);
}

// Player
ctx.fillStyle="lime";
ctx.fillRect(player.x,player.y,player.w,player.h);

// Enemy movement
enemy.y += enemy.speed;

if(enemy.y>500){
enemy.y=-100;
enemy.x=Math.random()*(canvas.width - enemy.w);
score++;
document.getElementById("score").innerText="Score: "+score;
}

ctx.fillStyle="red";
ctx.fillRect(enemy.x,enemy.y,enemy.w,enemy.h);

// Collision
if(collide(player,enemy)){
alert("Game Over ğŸ˜¢\nFinal Score: "+score);
location.reload();
}
}

// ğŸ¤– AI + Game Loop
async function main(){

await setupCamera();
const model = await handpose.load();

async function loop(){

const predictions = await model.estimateHands(video);

if(predictions.length>0){

const fingerX = predictions[0].landmarks[8][0];

// ğŸ” Mirror FIX (Control correct direction)
let newX = canvas.width - (fingerX / video.videoWidth) * canvas.width;

// Keep inside road
newX = Math.max(0, Math.min(canvas.width - player.w, newX));

// Smooth movement
player.x += (newX - player.x) * 0.3;
}

draw();
requestAnimationFrame(loop);
}

loop();
}

main();
</script>

</body>
</html>